# 修复evaluate.py模型加载问题

## 问题分析

当前`evaluate.py`中的模型初始化代码没有考虑`train.py`中添加的预训练词向量相关参数，导致以下问题：

1. **模型结构不匹配**：
   - `train.py`中的Encoder和Decoder类添加了`pretrained_embedding`和`freeze_embedding`参数
   - 当使用预训练词向量时，嵌入层的初始化方式不同
   - 如果嵌入维度与隐藏层维度不匹配，会添加额外的`embedding_proj`层

2. **权重加载失败风险**：
   - 由于模型结构不匹配，`model.load_state_dict()`可能会失败
   - 即使加载成功，模型行为也可能与训练时不一致

## 修复方案

修改`evaluate.py`中的模型初始化代码，确保与`train.py`中的模型结构完全一致：

1. **在RNN模型初始化中添加预训练词向量相关参数**：
   - 为`RNNEncoder`和`RNNDecoder`的初始化添加`pretrained_embedding=None`参数
   - 为`RNNEncoder`和`RNNDecoder`的初始化添加`freeze_embedding=False`参数

2. **确保Transformer模型初始化参数完整**：
   - 检查Transformer模型初始化参数是否与训练时一致

3. **添加必要的导入**：
   - 确保导入了所有必要的模块

## 修复步骤

1. 修改`evaluate.py`中的RNN模型初始化代码（第76-91行）
2. 修改`evaluate.py`中的Transformer模型初始化代码（第97-127行）
3. 测试修复后的代码能否正确加载模型权重

## 修复后预期效果

- `evaluate.py`能够正确加载`train.py`保存的模型权重
- 模型结构在训练和评估时完全一致
- 支持使用预训练词向量的模型评估
- 支持不同嵌入维度的模型评估

这个修复计划确保了训练和评估时的模型结构一致性，解决了模型权重加载失败的问题。