# 整合预训练词向量到RNN模型实现计划

## 1. 词表构造调整

### 1.1 修改词汇表类（vocabulary.py）
- 添加参数支持预训练词向量词汇表
- 修改词汇表构建逻辑，确保与预训练词向量兼容
- 优化OOV处理策略，增加可选的OOV映射方式

### 1.2 实现预训练词向量加载（utils/embedding.py）
- 创建新文件用于加载预训练词向量
- 支持中文腾讯AILAB词向量加载（.bin格式）
- 支持英文GLOVE词向量加载（.txt格式）
- 提供词向量查询和维度获取功能

## 2. 嵌入层重构

### 2.1 修改RNN编码器（encoder.py）
- 移除原有的嵌入层初始化方式
- 添加预训练词向量初始化支持
- 添加嵌入层可训练性配置选项
- 支持不同维度的预训练词向量

### 2.2 修改RNN解码器（decoder.py）
- 同样修改嵌入层，支持预训练词向量初始化
- 添加嵌入层可训练性配置选项
- 确保与编码器嵌入层参数兼容

## 3. 模型接口调整

### 3.1 修改RNN模型初始化（train.py）
- 添加预训练词向量路径命令行参数
- 添加嵌入层可训练性参数
- 添加嵌入维度参数（支持不同词向量维度）

### 3.2 支持维度匹配
- 如果预训练词向量维度与模型隐藏层维度不匹配，添加线性映射层
- 提供可选的维度调整策略（截断、补零、线性映射）

## 4. 实现步骤

1. 创建嵌入工具模块：`utils/embedding.py`
2. 修改词汇表类：`data/vocabulary.py`
3. 修改编码器嵌入层：`models/rnn/encoder.py`
4. 修改解码器嵌入层：`models/rnn/decoder.py`
5. 更新训练脚本：`train.py`
6. 测试整合功能

## 5. 关键技术点

- 预训练词向量格式处理（.bin和.txt）
- 词汇表与预训练词向量的对齐
- 不同维度词向量的兼容处理
- 嵌入层参数的可训练性控制

## 6. 预期效果

- 支持加载中文腾讯AILAB和英文GLOVE预训练词向量
- 模型嵌入层使用预训练词向量初始化
- 支持嵌入层参数是否可训练的配置
- 支持不同维度词向量的兼容处理
- 保持原有模型架构的兼容性

这个计划将实现用户要求的所有功能，同时保持代码的模块化和可扩展性。